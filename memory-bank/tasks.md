# TASKS - Crypto Helper Telegram Bot (–ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞)

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
–ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ª–æ–≥–∏–∫–∏ Telegram-–±–æ—Ç–∞ –¥–ª—è –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –æ–±–º–µ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –Ω–∞—Ü–µ–Ω–∫–∏ –∏ —Ä–∞—Å—á–µ—Ç–æ–º —Å–¥–µ–ª–æ–∫. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ —Ñ–ª–æ—É –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç –≤–º–µ—Å—Ç–æ –≥–æ—Ç–æ–≤—ã—Ö –≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä.

## –£—Ä–æ–≤–µ–Ω—å —Å–ª–æ–∂–Ω–æ—Å—Ç–∏
**–£—Ä–æ–≤–µ–Ω—å: 3 (Intermediate Feature)**
**–¢–∏–ø: Feature Development (Clean Slate)**

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **–Ø–∑—ã–∫**: Python 3.11
- **Telegram Bot Framework**: Aiogram 3.10
- **HTTP Client**: aiohttp
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è**: python-dotenv
- **API**: Rapira API + API Layer –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤
- **–•—Ä–∞–Ω–∏–ª–∏—â–µ**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (MVP)

## –°—Ç–∞—Ç—É—Å –º–∏–≥—Ä–∞—Ü–∏–∏
- [x] –°–æ–∑–¥–∞–Ω–∞ –Ω–æ–≤–∞—è –≤–µ—Ç–∫–∞ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚úÖ
- [x] –£–¥–∞–ª–µ–Ω—ã —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ —Ñ–∞–π–ª—ã –ª–æ–≥–∏–∫–∏ ‚úÖ
- [x] –û—á–∏—â–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –Ω–æ–≤–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ ‚úÖ
- [x] –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ - –§–∞–∑–∞ 1 ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê

## –£–¥–∞–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã (—Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞)
- `src/handlers/currency_pairs.py` - –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–µ –≤–∞–ª—é—Ç–Ω—ã–µ –ø–∞—Ä—ã
- `src/handlers/calculation_logic.py` - —Å—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞—Ü–µ–Ω–∫–∏
- `src/handlers/fsm_states.py` - —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ —Ñ–ª–æ—É
- `src/handlers/keyboards.py` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä
- `src/handlers/formatters.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏
- `src/handlers/validation.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–ª—è —Å—Ç–∞—Ä–æ–π —Å–∏—Å—Ç–µ–º—ã
- `src/handlers/margin_calculation.py` - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

## –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- `src/handlers/bot_handlers.py` - —É–ø—Ä–æ—â–µ–Ω –¥–æ –∑–∞–≥–ª—É—à–∫–∏
- `src/handlers/admin_handlers.py` - –∫–æ–º–∞–Ω–¥–∞ `/admin_bot` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–≥–ª—É—à–∫—É
- `src/bot.py` - –æ–±–Ω–æ–≤–ª–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –∏–º–ø–æ—Ä—Ç—ã
- `src/config.py` - —É–±—Ä–∞–Ω—ã `SUPPORTED_PAIRS`
- `src/handlers/__init__.py` - —É–ø—Ä–æ—â–µ–Ω—ã —ç–∫—Å–ø–æ—Ä—Ç—ã

## –ù–æ–≤—ã–π –±–∏–∑–Ω–µ—Å-—Ñ–ª–æ—É —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–æ–º–ø—Ç—É

### –ö–æ–º–∞–Ω–¥–∞ –∑–∞–ø—É—Å–∫–∞: `/admin_bot`

### –®–∞–≥ 1: –í—ã–±–æ—Ä –≤–∞–ª—é—Ç—ã –¥–ª—è –æ–±–º–µ–Ω–∞
- –ö–Ω–æ–ø–∫–∏: `RUB` –∏ `USDT`
- **–õ–æ–≥–∏–∫–∞:**
  - `RUB` = –ö–ª–∏–µ–Ω—Ç –æ—Ç–¥–∞–µ—Ç —Ä—É–±–ª–∏
  - `USDT` = –ö–ª–∏–µ–Ω—Ç –æ—Ç–¥–∞–µ—Ç –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç—É (USDT)

### –®–∞–≥ 2: –í—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–π –≤–∞–ª—é—Ç—ã
- **–ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ `RUB`** ‚Üí –∫–Ω–æ–ø–∫–∏: `USDT`, `USD`, `EUR`
- **–ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ `USDT`** ‚Üí –∫–Ω–æ–ø–∫–∞: `RUB`
- **–§–æ—Ä–º–∞—Ç –ø–∞—Ä—ã:** `[–û—Ç–¥–∞–≤–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞]` ‚Üí `[–ü–æ–ª—É—á–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞]`

### –®–∞–≥ 3: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞ –∏ –∑–∞–ø—Ä–æ—Å –Ω–∞—Ü–µ–Ω–∫–∏
- **–£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:** `1 USDT = [—á–∏—Å–ª–æ] RUB` (–¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä)
- **–ò—Å—Ç–æ—á–Ω–∏–∫–∏:** Rapira API + API Layer
- **–í–≤–æ–¥:** –¢–æ–ª—å–∫–æ —á–∏—Å–ª–æ (float/int): `2`, `1.5`, `0.75`

### –®–∞–≥ 4: –†–∞—Å—á–µ—Ç –Ω–∞—Ü–µ–Ω–∫–∏
- **RUB‚ÜíUSDT/USD/EUR:** `–ò—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å = –ë–∞–∑–æ–≤—ã–π √ó (1 + –Ω–∞—Ü–µ–Ω–∫–∞/100)`
- **USDT‚ÜíRUB:** `–ò—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å = –ë–∞–∑–æ–≤—ã–π √ó (1 - –Ω–∞—Ü–µ–Ω–∫–∞/100)`

### –®–∞–≥ 5: –í–≤–æ–¥ —Å—É–º–º—ã —Å–¥–µ–ª–∫–∏
- **–§–æ—Ä–º–∞—Ç:** –¢–æ–ª—å–∫–æ —á–∏—Å–ª–æ (int/float)
- **–õ–æ–≥–∏–∫–∞:** –°—É–º–º–∞ –≤ –æ—Ç–¥–∞–≤–∞–µ–º–æ–π –≤–∞–ª—é—Ç–µ

### –®–∞–≥ 6: –†–∞—Å—á–µ—Ç –∏ –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- **RUB‚ÜíUSDT/USD/EUR:** `–†–µ–∑—É–ª—å—Ç–∞—Ç = –°—É–º–º–∞ RUB / –ò—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å`
- **USDT‚ÜíRUB:** `–†–µ–∑—É–ª—å—Ç–∞—Ç = –°—É–º–º–∞ USDT √ó –ò—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å`

## –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FSM ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê
1. **–°–æ–∑–¥–∞–Ω–∏–µ FSM —Å–æ—Å—Ç–æ—è–Ω–∏–π**
   - [x] `WAITING_FOR_SOURCE_CURRENCY` - –≤—ã–±–æ—Ä RUB/USDT ‚úÖ
   - [x] `WAITING_FOR_TARGET_CURRENCY` - –≤—ã–±–æ—Ä —Ü–µ–ª–µ–≤–æ–π –≤–∞–ª—é—Ç—ã ‚úÖ
   - [x] `WAITING_FOR_MARGIN` - –≤–≤–æ–¥ –Ω–∞—Ü–µ–Ω–∫–∏ % ‚úÖ
   - [x] `WAITING_FOR_AMOUNT` - –≤–≤–æ–¥ —Å—É–º–º—ã —Å–¥–µ–ª–∫–∏ ‚úÖ
   - [x] `SHOWING_RESULT` - –ø–æ–∫–∞–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚úÖ

2. **–°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π**
   - [x] `src/handlers/fsm_states.py` - –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π FSM ‚úÖ
   - [x] `src/handlers/admin_flow.py` - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–ª–æ—É /admin_bot ‚úÖ
   - [x] `src/handlers/keyboards.py` - –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞ ‚úÖ
   - [x] `src/handlers/validators.py` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤–≤–æ–¥–æ–≤ ‚úÖ
   - [x] `src/bot.py` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–æ—É—Ç–µ—Ä–∞ —Å FSM —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º ‚úÖ
   - [x] `src/handlers/__init__.py` - —ç–∫—Å–ø–æ—Ä—Ç –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π ‚úÖ

### –§–∞–∑–∞ 2: –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê
3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç**
   - [x] –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ admin_flow.py) ‚úÖ
   - [x] –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ –∏—Å—Ö–æ–¥–Ω–æ–π –≤–∞–ª—é—Ç—ã (RUB/USDT) ‚úÖ
   - [x] –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∫–Ω–æ–ø–∫–∏ —Ü–µ–ª–µ–≤–æ–π –≤–∞–ª—é—Ç—ã ‚úÖ
   - [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –ø–∞—Ä ‚úÖ

4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∞–ª—é—Ç**
   - [x] Enum –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –≤–∞–ª—é—Ç (fsm_states.py) ‚úÖ
   - [x] –ü—Ä–∞–≤–∏–ª–∞ –¥–æ–ø—É—Å—Ç–∏–º—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π ‚úÖ
   - [x] –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤–∞–ª—é—Ç ‚úÖ

### –§–∞–∑–∞ 3: API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ä–∞—Å—á–µ—Ç—ã ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê
5. **–ü–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤**
   - [x] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –∫—É—Ä—Å–∞ "1 USDT = X RUB" ‚úÖ
   - [x] –ö—Ä–æ—Å—Å-–∫—É—Ä—Å—ã –¥–ª—è RUB‚ÜíUSD/EUR —á–µ—Ä–µ–∑ USDT ‚úÖ
   - [x] –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API (fallback) ‚úÖ

6. **–õ–æ–≥–∏–∫–∞ —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞—Ü–µ–Ω–∫–∏**
   - [x] –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –Ω–∞—Ü–µ–Ω–∫–∏ (—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ admin_flow.py) ‚úÖ
   - [x] –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π ‚úÖ
   - [x] –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Decimal –¥–ª—è —Ç–æ—á–Ω–æ—Å—Ç–∏ ‚úÖ
   - [x] –ü—Ä–∞–≤–∏–ª–∞ –æ–∫—Ä—É–≥–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ ‚úÖ

### –§–∞–∑–∞ 4: –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê
7. **–í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Ü–µ–Ω–∫–∏**
   - [x] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤: `2`, `1.5`, `2,5` ‚Üí `1.5` ‚úÖ
   - [x] –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è: 0.1% - 10% ‚úÖ
   - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–≤–æ–¥–∞ ‚úÖ

8. **–í–∞–ª–∏–¥–∞—Ü–∏—è —Å—É–º–º—ã**
   - [x] –¢–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è ‚úÖ
   - [x] –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Å—É–º–º—ã –¥–ª—è –æ–±–º–µ–Ω–∞ ‚úÖ
   - [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—É–º–Ω—ã—Ö –ª–∏–º–∏—Ç–æ–≤ ‚úÖ

### –§–∞–∑–∞ 5: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ UI ‚úÖ –ó–ê–í–ï–†–®–ï–ù–ê
9. **–°–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é**
   - [x] `src/handlers/formatters.py` - —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π ‚úÖ
   - [x] –®–∞–±–ª–æ–Ω —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚úÖ
   - [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ ‚úÖ

10. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º**
    - [x] –ö–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∞" –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ ‚úÖ
    - [x] –ö–Ω–æ–ø–∫–∞ "–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞" –ø–æ—Å–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚úÖ
    - [x] –ù–∞–≤–∏–≥–∞—Ü–∏—è –Ω–∞–∑–∞–¥ –ø–æ —à–∞–≥–∞–º ‚úÖ

### –§–∞–∑–∞ 6: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞ üîÑ –ß–ê–°–¢–ò–ß–ù–û –ó–ê–í–ï–†–®–ï–ù–ê
11. **Unit —Ç–µ—Å—Ç—ã**
    - [x] –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã FSM –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã (test_phase1_implementation.py) ‚úÖ
    - [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã —Ä–∞—Å—á–µ—Ç–∞ –Ω–∞—Ü–µ–Ω–∫–∏
    - [ ] –£–≥–ª—É–±–ª–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–≤–æ–¥–æ–≤

12. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã**
    - [ ] –ü–æ–ª–Ω—ã–π —Ñ–ª–æ—É —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
    - [ ] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API
    - [ ] –ì—Ä–∞–Ω–∏—á–Ω—ã–µ —Å–ª—É—á–∞–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π
```
handlers/
‚îú‚îÄ‚îÄ admin_flow.py          # –û—Å–Ω–æ–≤–Ω–æ–π —Ñ–ª–æ—É /admin_bot
‚îú‚îÄ‚îÄ currency_selection.py  # –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç
‚îú‚îÄ‚îÄ amount_input.py        # –í–≤–æ–¥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å—É–º–º—ã
‚îú‚îÄ‚îÄ margin_input.py        # –í–≤–æ–¥ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Ü–µ–Ω–∫–∏
‚îú‚îÄ‚îÄ calculation.py         # –†–∞—Å—á–µ—Ç—ã –∫—É—Ä—Å–∞ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
‚îú‚îÄ‚îÄ keyboards.py           # –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
‚îú‚îÄ‚îÄ validators.py          # –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤–≤–æ–¥–æ–≤
‚îú‚îÄ‚îÄ formatters.py          # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
‚îî‚îÄ‚îÄ fsm_states.py          # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
```

### Domain –º–æ–¥–µ–ª–∏
```python
class Currency(Enum):
    RUB = "RUB"
    USDT = "USDT"
    USD = "USD"
    EUR = "EUR"

class ExchangeRate:
    base: Currency
    quote: Currency
    rate: Decimal
    timestamp: datetime

class Deal:
    source_currency: Currency
    target_currency: Currency
    amount: Decimal
    margin_percent: Decimal
    exchange_rate: ExchangeRate
    result: Decimal
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```python
SUPPORTED_SOURCES = [Currency.RUB, Currency.USDT]
TARGETS_FOR_RUB = [Currency.USDT, Currency.USD, Currency.EUR]
TARGETS_FOR_USDT = [Currency.RUB]
MIN_MARGIN = 0.1
MAX_MARGIN = 10.0
```

## –ü—Ä–∏–º–µ—Ä—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: RUB ‚Üí USDT
1. –û–ø–µ—Ä–∞—Ç–æ—Ä: `/admin_bot`
2. –í—ã–±–æ—Ä: `RUB` ‚Üí `USDT`
3. –ö—É—Ä—Å: `1 USDT = 80 RUB`
4. –ù–∞—Ü–µ–Ω–∫–∞: `2%` ‚Üí –∏—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å: `81.6 RUB`
5. –°—É–º–º–∞: `1000 RUB`
6. –†–µ–∑—É–ª—å—Ç–∞—Ç: `1000 / 81.6 ‚âà 12.25 USDT`

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: USDT ‚Üí RUB
1. –û–ø–µ—Ä–∞—Ç–æ—Ä: `/admin_bot`
2. –í—ã–±–æ—Ä: `USDT` ‚Üí `RUB`
3. –ö—É—Ä—Å: `1 USDT = 80 RUB`
4. –ù–∞—Ü–µ–Ω–∫–∞: `2%` ‚Üí –∏—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å: `78.4 RUB`
5. –°—É–º–º–∞: `10 USDT`
6. –†–µ–∑—É–ª—å—Ç–∞—Ç: `10 √ó 78.4 = 784 RUB`

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: RUB ‚Üí USD (—á–µ—Ä–µ–∑ –∫—Ä–æ—Å—Å-–∫—É—Ä—Å)
1. –û–ø–µ—Ä–∞—Ç–æ—Ä: `/admin_bot`
2. –í—ã–±–æ—Ä: `RUB` ‚Üí `USD`
3. –ü–æ–ª—É—á–µ–Ω–∏–µ: USDT/RUB (80) + USD/USDT (0.998)
4. –ö—Ä–æ—Å—Å-–∫—É—Ä—Å: `1 USD = 80.16 RUB`
5. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ: `1 USDT = 80 RUB` (–±–∞–∑–æ–≤—ã–π)
6. –ù–∞—Ü–µ–Ω–∫–∞: `2%` ‚Üí `81.76 RUB –∑–∞ USD`
7. –°—É–º–º–∞: `1000 RUB`
8. –†–µ–∑—É–ª—å—Ç–∞—Ç: `1000 / 81.76 ‚âà 12.23 USD`

## –®–∞–±–ª–æ–Ω —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
```
‚úÖ –°–¥–µ–ª–∫–∞: [–æ—Ç–¥–∞–≤–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞] ‚Üí [–ø–æ–ª—É—á–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞]
‚Ä¢ –°—É–º–º–∞: [–≤–≤–µ–¥–µ–Ω–Ω–∞—è —Å—É–º–º–∞] [–æ—Ç–¥–∞–≤–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞]
‚Ä¢ –ö—É—Ä—Å (—Å –Ω–∞—Ü–µ–Ω–∫–æ–π X%): 1 USDT = [–∏—Ç–æ–≥–æ–≤—ã–π –∫—É—Ä—Å] RUB
‚Ä¢ –ò—Ç–æ–≥–æ: [—Ä–µ–∑—É–ª—å—Ç–∞—Ç] [–ø–æ–ª—É—á–∞–µ–º–∞—è –≤–∞–ª—é—Ç–∞]
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ ‚úÖ –í–´–ü–û–õ–ù–ï–ù–´
- [x] –ö–æ–º–∞–Ω–¥–∞ `/admin_bot` –∑–∞–ø—É—Å–∫–∞–µ—Ç –Ω–æ–≤—ã–π —Ñ–ª–æ—É ‚úÖ
- [x] –í—Å–µ 4 –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø–∞—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç (RUB‚ÜíUSDT/USD/EUR, USDT‚ÜíRUB) ‚úÖ
- [x] –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞ "1 USDT = X RUB" ‚úÖ
- [x] –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞—Ü–µ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π ‚úÖ
- [x] –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤–≤–æ–¥–æ–≤ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏ ‚úÖ
- [x] FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ ‚úÖ
- [x] –ö–Ω–æ–ø–∫–∏ "–û—Ç–º–µ–Ω–∞" –∏ "–ù–æ–≤–∞—è —Å–¥–µ–ª–∫–∞" ‚úÖ
- [x] –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API —Å fallback ‚úÖ
- [x] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –æ—Å–Ω–æ–≤–Ω—É—é –ª–æ–≥–∏–∫—É ‚úÖ

## –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏–π
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- [ ] –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–¥–µ–ª–æ–∫ –∑–∞ –¥–µ–Ω—å
- [ ] –†—É—á–Ω–æ–π –≤–≤–æ–¥ –∫—É—Ä—Å–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ API
- [ ] –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞—Ü–µ–Ω–∫–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É
- [ ] A/B —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö UI
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Ä–µ–∑–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö –∫—É—Ä—Å–∞
- [ ] –≠–∫—Å–ø–æ—Ä—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ Excel

## –û–°–ù–û–í–ù–û–ô –§–£–ù–ö–¶–ò–û–ù–ê–õ –ü–û–õ–ù–û–°–¢–¨–Æ –ó–ê–í–ï–†–®–ï–ù! üéâ

**–°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
- ‚úÖ **–§–ê–ó–ê 1:** –ë–∞–∑–æ–≤–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ FSM - –ó–ê–í–ï–†–®–ï–ù–ê
- ‚úÖ **–§–ê–ó–ê 2:** –õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –≤–∞–ª—é—Ç - –ó–ê–í–ï–†–®–ï–ù–ê
- ‚úÖ **–§–ê–ó–ê 3:** API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏ —Ä–∞—Å—á–µ—Ç—ã - –ó–ê–í–ï–†–®–ï–ù–ê  
- ‚úÖ **–§–ê–ó–ê 4:** –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è - –ó–ê–í–ï–†–®–ï–ù–ê
- ‚úÖ **–§–ê–ó–ê 5:** –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ UI - –ó–ê–í–ï–†–®–ï–ù–ê
- üîÑ **–§–ê–ó–ê 6:** –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ - –ß–ê–°–¢–ò–ß–ù–û –ó–ê–í–ï–†–®–ï–ù–ê

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- ‚úÖ –ü–æ–ª–Ω—ã–π –ø–æ—à–∞–≥–æ–≤—ã–π —Ñ–ª–æ—É –æ–±–º–µ–Ω–∞ –≤–∞–ª—é—Ç
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π: RUB‚ÜíUSDT/USD/EUR, USDT‚ÜíRUB
- ‚úÖ –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞ "1 USDT = X RUB"
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞ –Ω–∞—Ü–µ–Ω–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤–≤–æ–¥–æ–≤ —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏
- ‚úÖ Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –Ω–∞–≤–∏–≥–∞—Ü–∏–µ–π
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ API —Å fallback
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ unit —Ç–µ—Å—Ç—ã

**üöÄ –ë–û–¢ –ì–û–¢–û–í –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ! –ó–∞–ø—É—Å–∫: `python src/main.py`**

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
1. **–°—Ä–µ–¥–Ω–∏–π**: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ unit —Ç–µ—Å—Ç—ã —Ä–∞—Å—á–µ—Ç–æ–≤ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
2. **–°—Ä–µ–¥–Ω–∏–π**: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã –ø–æ–ª–Ω–æ–≥–æ —Ñ–ª–æ—É
3. **–ù–∏–∑–∫–∏–π**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–∞–ª—é—Ç—ã (AED, THB, ZAR, IDR)  
4. **–ù–∏–∑–∫–∏–π**: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–π –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
5. **–ù–∏–∑–∫–∏–π**: –†—É—á–Ω–æ–π –≤–≤–æ–¥ –∫—É—Ä—Å–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ API
6. **–ù–∏–∑–∫–∏–π**: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –Ω–∞—Ü–µ–Ω–∫–∏ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É